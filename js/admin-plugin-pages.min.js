jQuery(document).ready(function(a){function c(a,b,c){return'<div class="notification"><span class="'+c+'">'+(a?"<h4>"+a+"</h4>":"")+(b?b:"")+"</span></div>"}var b=a("#epub_admin_wrap");!function(){function c(c,d){b.find(c+" > .nav_tab").on("click",function(){b.find(c+" > .nav_tab").removeClass("active"),a(this).addClass("active"),b.find(d+" > .tab-panel").removeClass("active");var e=a(this).index()+1;b.find(d+" > .tab-panel:nth-child( "+e+" ) ").addClass("active")})}c("#welcome_tab_nav","#welcome_panel_container"),c(".main-nav > .nav-tabs","#main_panels"),c("#help_tabs_nav","#help_tab_panel")}(),b.find(".save_settings").on("click",function(d){d.preventDefault();var e="",f={action:"epub_save_settings",_wpnonce_epub_save_settings:a("#_wpnonce_epub_save_settings").val(),form:a("form").serialize()};a.ajax({type:"POST",dataType:"json",data:f,url:ajaxurl,beforeSend:function(b){a("#epub-ajax-in-progress").dialog("open")}}).done(function(d){function f(){location.reload()}d=d?d:"",void 0!=d.message?(e=d.message,e.indexOf("reload")>=0&&(e=e.replace("reload ",""),b.find("#top-notice-message").html(e),e="",a("html, body").animate({scrollTop:0},"slow"),window.setTimeout(f,2e3))):e=c("",d.error?d.error:"Please reload the page and try again (b1).","error")}).fail(function(a,b,d){e=d?" ["+d+"]":"unknown error",e=c("Error occurred - configuration NOT saved. Please try again later",e,"error")}).always(function(){a("#epub-ajax-in-progress").dialog("close"),e&&(b.find("#top-notice-message").html(e),a("html, body").animate({scrollTop:0},"slow"))})}),b.find("#send_feedback").on("click",function(d){b.find(".required").remove(),d.preventDefault();var e="",f=b.find("#your_feedback").val();if(!f)return void b.find("#your_feedback").after('<p class="required notification"><span class="error">* Feedback message is required</span> </p>');var g={action:"epub_send_feedback",_wpnonce_epub_send_feedback:a("#_wpnonce_epub_send_feedback").val(),feedback:f,email:b.find("#your_email").val()};a.ajax({type:"POST",dataType:"json",data:g,url:ajaxurl,beforeSend:function(b){a("#epub-ajax-in-progress-feedback").dialog("open")}}).done(function(a){a=a?a:"",e=void 0!=a.message?a.message:c("",a.error?a.error:"Please reload the page and try again (b1).","error")}).fail(function(a,b,d){e=d?" ["+d+"]":"unknown error",e=c("Error occurred - feedback NOT sent. Please try again later",e,"error")}).always(function(){a("#epub-ajax-in-progress-feedback").dialog("close"),e&&(b.find("#top-notice-message").html(e),a("html, body").animate({scrollTop:0},"slow"))})}),b.find("#close_intro").on("click",function(){b.find(".welcome_header").hide();var c={action:"epub_close_welcome_header"};a.ajax({type:"POST",dataType:"json",url:ajaxurl,data:c})}),a("#epub-dialog-info").dialog({resizable:!1,height:250,width:400,modal:!0,autoOpen:!1,buttons:{Ok:function(){a(this).dialog("close");var b=a(this).find("#epub-dialog-msg").html();(b.indexOf("reload")>0||b.indexOf("refresh")>0)&&location.reload()}}}).hide();var d=a("#epub-dialog-info-icon").dialog({resizable:!1,autoOpen:!1,modal:!0,buttons:{Ok:function(){a(this).dialog("close")}},close:function(){a("#epub-dialog-info-icon-msg").html()}});b.find(".info-icon").on("click",function(){var b=!1,c="",e=a(this).parent().find(".label").text();e=e?e:"";var f=a(this).find("p").html();if(f){var g=f.split("@");f=g[0]?g[0]:"Help text coming soon.",g[1]&&(b=!0,c='<img class="epub-help-image" src="'+g[1]+'">')}else f="Help text coming soon.";a("#epub-dialog-info-icon-msg").html("<p>"+f+"</p><br/>"+c),d.dialog({title:e,width:b?1e3:400,maxHeight:b?750:300,open:function(){a("#epub-dialog-info-icon").find(".epub-help-image").one("load",function(){d.dialog("option",{position:{my:"center",at:"center",of:window}})}),a(".ui-widget-overlay").bind("click",function(){a("#epub-dialog-info-icon").dialog("close")})}}).dialog("open")}),a("#epub-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!0,autoOpen:!1}).hide(),a("#epub-ajax-in-progress-feedback").dialog({resizable:!1,height:70,width:300,modal:!0,autoOpen:!1}).hide(),a(".ui-dialog-titlebar").hide(),function(){b.find(".featured_img").on("click",function(){b.find(".image_zoom").remove();var c=a(this).find("img").attr("src");a(this).after('<div class="image_zoom"><img src="'+c+'" class="image_zoom"><span class="close icon_close"></span></div>')}),a("body").on("click",".image_zoom .close",function(){a(this).parent().remove()})}()});